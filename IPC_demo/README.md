# IPC demo
> 管道/消息队列/共享内存： 手段都是通过在【内存上】开辟一段空间，供给进程之间通信
>      管道 && 消息队列： 数据量小的比较友好，通过api来读写
>             共享内存： 数据量大的时候必须使用，shm直接通过地址来进行读写，不用api
## 1. 匿名管道
## 2. 有名管道
- 单向通信(fifo_1way)
  - SEND: 发送端
  - RECV: 接收端
- 双向通信(fifo_2way)

## 3. 共享内存
> ipcs命令，查看 shm/msg-queue 详情</br>
> 删除共享内存的话，命令：ipcrm -M [key] | ipcrm -m [序号]
- 和mmap的区别
  - mmap是将进程的一段vp映射到pp而已，这段区域并不shared
  - 如果多个进程映射到同一个pp的话，就会触发【私有的写时复制】
- 进程也是根据【时间片】来执行的，if 写满一个共享内存需要【多个时间片】，此时切换到另一个进程了，共享内存就可能被写坏
- 共享内存需要保护
- 相关函数：
  - shmget(key, size, flag): key值，4k的整数倍大小，文件权限(0664|IPC_CREAT)
  - shmat(shmid, (void*)shmaddr, flag): 创建好的shmid，映射的虚拟地址起始地址(NULL-内核自定一个vp来开始映射)，flag映射条件（0-可读可写；shm_RDONLY-只读；1-只写）
  - 注意：进程退出删除这个shm，要先把映射关系解除